⚡ QUICK START — Быстрый старт v0.0.5
════════════════════════════════════════════════════════════════════════════

🚀 3 ШАГА ДО ЗАПУСКА БОТА

════════════════════════════════════════════════════════════════════════════
ШАГ 1: Подготовка окружения (2 минуты)
════════════════════════════════════════════════════════════════════════════

Windows PowerShell:
───────────────────

# 1. Установить зависимости
pip install -r bot_v0.0.2/requirements.txt

# 2. Создать/обновить .env файл (в папке bot_v0.0.2)
cat > bot_v0.0.2/.env << 'EOF'
BOT_TOKEN=<ваш_токен_от_BotFather>
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=<ваш_anon_ключ>
CRYPTOBOT_TOKEN=<ваш_cryptobot_токен>
FREEKASSA_MERCHANT_ID=<ваш_merchant_id>
FREEKASSA_SECRET1=<ваш_secret1>
FREEKASSA_SECRET2=<ваш_secret2>
LOG_LEVEL=INFO
EOF

# 3. Перейти в папку проекта
cd bot_v0.0.2


════════════════════════════════════════════════════════════════════════════
ШАГ 2: Создание таблицы в Supabase (2 минуты)
════════════════════════════════════════════════════════════════════════════

1. Откройте https://supabase.com → перейти в ваш проект
2. Нажмите "SQL Editor" (слева в меню)
3. Нажмите "New Query"
4. Скопируйте содержимое файла: database/migrations/001_create_payments_table.sql
5. Вставьте в SQL редактор
6. Нажмите "Run" (или Ctrl+Enter)

Должно выполниться без ошибок и создаться:
  ✓ Таблица payments
  ✓ Индексы
  ✓ Триггер


════════════════════════════════════════════════════════════════════════════
ШАГ 3: Запуск бота (1 минута)
════════════════════════════════════════════════════════════════════════════

# Запустить бот
python bot.py

Ожидайте этого вывода:
  ✅ Подключение к Supabase успешно
  ✅ CryptoBot payment service инициализирован
  ✅ FreeKassa service initialized
  ✅ Callback HTTP server started on 0.0.0.0:8080
  ✅ Бот запущен: @<ваш_бот>

Готово! Бот работает. 🎉


════════════════════════════════════════════════════════════════════════════
🧪 ПЕРВОЕ ТЕСТИРОВАНИЕ
════════════════════════════════════════════════════════════════════════════

1. Откройте Telegram и напишите вашему боту: /start

2. Должны увидеть главное меню с кнопками:
   ✓ 👤 Профиль
   ✓ 💰 Баланс
   ✓ ⚙️ Автоматический заработок
   ✓ 💳 Пополнить баланс
   ✓ и т.д.

3. Нажмите "💳 Пополнить баланс"

4. Должны увидеть меню с 4 способами оплаты:
   ✓ 🪙 Оплатить TON
   ✓ 💵 Оплатить USDT
   ✓ ₿ Оплатить Bitcoin
   ✓ 💳 Оплатить через FreeKassa

5. Выберите способ (например, TON)

6. Выберите сумму (например, 1 TON)

7. Вы получите ссылку для оплаты

8. Проверьте в Supabase таблицу payments:
   SELECT * FROM payments ORDER BY created_at DESC;

   Должна появиться запись с:
   - user_id: ваш Telegram ID
   - currency: TON
   - amount: 1
   - status: pending
   - tx_id: <invoice_id>


════════════════════════════════════════════════════════════════════════════
🔗 ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ
════════════════════════════════════════════════════════════════════════════

Откуда получить ключи:

BOT_TOKEN:
  → Telegram: @BotFather → /newbot → скопировать токен

SUPABASE_URL и SUPABASE_KEY:
  → https://supabase.com → Settings → API → Copy URL/Key (anon)

CRYPTOBOT_TOKEN:
  → Telegram: @CryptoBot → /api → следовать инструкциям

FREEKASSA_MERCHANT_ID / SECRET1 / SECRET2:
  → https://www.free-kassa.ru → Личный кабинет → Магазины → Настройки


════════════════════════════════════════════════════════════════════════════
📊 ЕСЛИ ЧТО-ТО НЕ РАБОТАЕТ
════════════════════════════════════════════════════════════════════════════

❌ "ModuleNotFoundError: No module named 'aiogram'"
→ pip install -r requirements.txt

❌ "sqlite3: database is locked"
→ Проверьте что bot.log не открыт в другом процессе

❌ "Callback HTTP server not started"
→ Порт 8080 занят. Используйте: lsof -i :8080 (Mac/Linux)

❌ "SUPABASE_URL не найден"
→ Проверьте что .env файл создан в папке bot_v0.0.2

❌ "CryptoBot не инициализирован"
→ Это нормально, если CRYPTOBOT_TOKEN не заполнен
→ Заполните если хотите использовать CryptoBot

❌ Проверьте логи:
→ tail -f bot.log
→ Ищите ошибки при запуске


════════════════════════════════════════════════════════════════════════════
📚 ПОДРОБНАЯ ДОКУМЕНТАЦИЯ
════════════════════════════════════════════════════════════════════════════

После успешного запуска, прочитайте:

1. UPGRADE_TO_v0.0.5.md
   ↓
   Полное руководство по конфигурации и настройке webhook'ов

2. TESTING_GUIDE_v0.0.5.md
   ↓
   Пошаговое тестирование всех функций

3. VERSION_0.0.5_SUMMARY.md
   ↓
   Полный обзор того что было реализовано

4. PROJECT_STRUCTURE.md
   ↓
   Описание структуры файлов проекта


════════════════════════════════════════════════════════════════════════════
🎯 СЛЕДУЮЩИЕ ШАГИ
════════════════════════════════════════════════════════════════════════════

После тестирования локально:

1️⃣ Настройка webhook'ов (для автоматического зачисления):
   → CryptoBot: Настроить URL callback'а
   → FreeKassa: Настроить URL callback'а

2️⃣ Использование ngrok (для локального тестирования):
   ngrok http 8080
   → Скопировать URL и настроить в провайдере

3️⃣ Production развёртывание:
   → Используйте VPS / Heroku / CloudRun
   → Настройте SSL/HTTPS
   → Настройте webhook'ы


════════════════════════════════════════════════════════════════════════════
💡 ПОЛЕЗНЫЕ КОМАНДЫ
════════════════════════════════════════════════════════════════════════════

# Остановить бота (Ctrl+C)

# Просмотр логов
tail -f bot.log

# Проверить синтаксис Python файла
python -m py_compile handlers/payments_handler.py

# Проверить подключение к Supabase
python -c "import supabase; print('OK')"

# Запустить тесты webhook'ов
python test_webhooks.py

# Посмотреть процессы на порту 8080
lsof -i :8080  (Mac/Linux)
netstat -ano | findstr :8080  (Windows)


════════════════════════════════════════════════════════════════════════════
✅ ЧЕКЛИСТ УСПЕШНОГО ЗАПУСКА
════════════════════════════════════════════════════════════════════════════

[✓] .env файл создан и заполнен
[✓] Зависимости установлены (pip install -r requirements.txt)
[✓] Таблица payments создана в Supabase
[✓] Бот успешно запущен (python bot.py)
[✓] Получено сообщение "Callback HTTP server started"
[✓] Бот отвечает на /start в Telegram
[✓] Меню платежей доступно
[✓] Запись о платеже появляется в таблице payments
[✓] Нет ошибок в логах


════════════════════════════════════════════════════════════════════════════
📞 КОНТАКТ И ПОДДЕРЖКА
════════════════════════════════════════════════════════════════════════════

Если остались вопросы:
  → Telegram: @Danyadlyalubvi2
  → Email: (если есть)
  → GitHub Issues: (если есть)


════════════════════════════════════════════════════════════════════════════
🎊 ПОЗДРАВЛЯЕМ!
════════════════════════════════════════════════════════════════════════════

Вы успешно установили версию 0.0.5 бота!

Функции готовы к использованию:
  ✓ CryptoBot платежи (TON, USDT, BTC)
  ✓ FreeKassa интеграция
  ✓ Проверка статуса оплаты
  ✓ Автоматическое зачисление баланса
  ✓ Полная история платежей в БД

Наслаждайтесь! 🚀

════════════════════════════════════════════════════════════════════════════
