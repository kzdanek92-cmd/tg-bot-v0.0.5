📱 Развертывание бота на Render.com
═══════════════════════════════════════════════════════════════

🎯 Цель: Запустить бота 24/7 на бесплатном хостинге Render

⏱ Время: 10-15 минут

═══════════════════════════════════════════════════════════════
ШАГ 1: Подготовка GitHub репозитория
═══════════════════════════════════════════════════════════════

1. Если ещё нет GitHub аккаунта:
   → https://github.com/signup
   → Создайте аккаунт

2. На локальной машине откройте PowerShell в папке проекта:
   ```powershell
   cd "c:\Users\kzdan\OneDrive\Desktop\Новая папка"
   git init
   git add .
   git commit -m "Initial commit - v0.0.5"
   ```

3. Создайте новый репозиторий на GitHub:
   → Зайдите https://github.com/new
   → Название: tg-bot-v0.0.5 (или своё)
   → Public (чтобы Render мог access'ить)
   → Create repository

4. Добавьте remote и push'ните код:
   ```powershell
   git remote add origin https://github.com/ВАШ_ЮЗЕР/tg-bot-v0.0.5.git
   git branch -M main
   git push -u origin main
   ```

═══════════════════════════════════════════════════════════════
ШАГ 2: Регистрация на Render.com
═══════════════════════════════════════════════════════════════

1. Перейди на https://render.com
2. Нажми "Sign Up"
3. Выбери "Sign up with GitHub"
4. Авторизуй Render доступ к твоему GitHub

═══════════════════════════════════════════════════════════════
ШАГ 3: Создание Web Service на Render
═══════════════════════════════════════════════════════════════

1. На панели Render нажми "+ New" → "Web Service"

2. Выбери репозиторий:
   → "Connect a repository"
   → Выбери tg-bot-v0.0.5
   → Нажми "Connect"

3. Заполни форму:
   
   📝 Name: tg-bot-v0.0.5 (или любое имя)
   
   📝 Environment: Python
   
   📝 Build Command:
      ```
      pip install -r bot_v0.0.2/requirements.txt
      ```
   
   📝 Start Command:
      ```
      cd bot_v0.0.2 && python bot.py
      ```
   
   📝 Plan: Free (снизу)

4. Нажми "Create Web Service"

═══════════════════════════════════════════════════════════════
ШАГ 4: Добавление переменных окружения
═══════════════════════════════════════════════════════════════

ВАЖНО! Render не может читать .env файлы из GitHub.
Нужно вручную добавить переменные в панель.

1. На странице сервиса нажми "Environment" в левом меню

2. Добавь все переменные из .env:

   BOT_TOKEN = 8377810720:AAH_HA42Cezxe0apHh24DuyDxAiBvPstGHI
   
   SUPABASE_URL = https://wqerdkudikouqgsbsrnj.supabase.co
   
   SUPABASE_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   
   CRYPTOBOT_TOKEN = 487477:AAtpIbP21izkuwcDPWutkWtRfjlF3Gpbedk
   
   LOG_LEVEL = INFO
   
   FREEKASSA_MERCHANT_ID = (когда будет подтверждена кассa)
   FREEKASSA_SECRET1 = (когда будет подтверждена кассa)
   FREEKASSA_SECRET2 = (когда будет подтверждена кассa)

3. Нажми "Save"

4. Render автоматически перезапустит сервис с новыми переменными

═══════════════════════════════════════════════════════════════
ШАГ 5: Получение публичного URL
═══════════════════════════════════════════════════════════════

1. Жди 3-5 минут до полного deploy'а (смотри в Logs)

2. Когда deploy завершится, вверху страницы будет URL:
   https://tg-bot-v0.0.5.onrender.com
   (или другое имя)

3. Этот URL = твой публичный адрес для webhook'ов!

═══════════════════════════════════════════════════════════════
ШАГ 6: Обновление FreeKassa webhook'ов
═══════════════════════════════════════════════════════════════

1. Перейди в панель FreeKassa

2. Обнови URL'ы webhook'ов с новым Render URL:

   URL ОПОВЕЩЕНИЯ:
   https://tg-bot-v0.0.5.onrender.com/webhook/freekassa
   
   URL УСПЕШНОЙ ОПЛАТЫ:
   https://tg-bot-v0.0.5.onrender.com/payment-success
   
   URL ВОЗВРАТА:
   https://tg-bot-v0.0.5.onrender.com/payment-failed

3. Нажми "СОХРАНИТЬ И ПРОВЕРИТЬ"

═══════════════════════════════════════════════════════════════
ШАГ 7: Настройка автоматического перезапуска
═══════════════════════════════════════════════════════════════

На Free плане Render есть особенность:
- Если сервис неактивный 15 минут → он спит
- Нужно пробудить его (нажать в браузер на URL)

Чтобы избежать:
1. Нажми "Settings" в левом меню на Render
2. Прокрути до "Auto-Restart"
3. Выбери опцию сохранения данных (если есть)

Или используй бесплатный сервис для "пинга":
- https://uptimerobot.com (следит за сервисом и пингует каждые 5 минут)

═══════════════════════════════════════════════════════════════
✅ ГОТОВО!
═══════════════════════════════════════════════════════════════

Твой бот теперь работает 24/7 на Render.com!

Особенности Free плана Render:
✓ 750 часов/месяц (достаточно 24/7)
✓ HTTPS поддержка автоматическая
✓ Бесплатно
⚠ Спит если неактивный 15 мин (но пробуждается при запросе)
⚠ Лимиты на число процессов и память (для простого бота - достаточно)

═══════════════════════════════════════════════════════════════
🔄 ОБНОВЛЕНИЕ КОДА
═══════════════════════════════════════════════════════════════

Когда нужно обновить код:

1. Измени файлы локально
2. Сделай commit и push:
   ```
   git add .
   git commit -m "Fix something"
   git push origin main
   ```
3. Render автоматически заметит изменения
4. Автоматически запустит rebuild и перезапустит бота
5. Примерно через 3-5 минут новый код будет live

═══════════════════════════════════════════════════════════════
🆘 ЕСЛИ ЧТО-ТО НЕ РАБОТАЕТ
═══════════════════════════════════════════════════════════════

1. Смотри Logs на Render:
   → "Logs" в левом меню
   → Найди ошибку

2. Типичные ошибки:
   - "ModuleNotFoundError" → забыл добавить пакет в requirements.txt
   - "KeyError BOT_TOKEN" → забыл добавить переменные в Environment
   - "Connection refused" → неправильный SUPABASE_URL или SUPABASE_KEY

3. Чтобы перезапустить сервис:
   → "Settings" → "Restart Instance"

═══════════════════════════════════════════════════════════════

Вопросы? Чтение: QUICK_START.md или UPGRADE_TO_v0.0.5.md

═══════════════════════════════════════════════════════════════
